<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Random Internet Museum</title>
<style>
:root {
    --primary-color: #0f0;
    --secondary-color: #ff00ff;
    --bg-color: #000;
    --card-bg: #111;
    --text-color: #0f0;
    --accent-color: #00ffff;
}
* { box-sizing: border-box; }
body {
    background-color: var(--bg-color);
    color: var(--text-color);
    font-family: 'Courier New', monospace;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
    text-align: center;
    background-image:
        radial-gradient(circle at 10% 20%, rgba(0, 255, 0, 0.05) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(255, 0, 255, 0.05) 0%, transparent 20%);
}
header {
    width: 100%;
    margin-bottom: 30px;
    border-bottom: 2px solid var(--primary-color);
    padding-bottom: 15px;
}
h1 {
    font-size: 2.5rem;
    margin: 0;
    text-shadow: 0 0 10px var(--primary-color);
    animation: glow 2s ease-in-out infinite alternate;
}
@keyframes glow {
    from { text-shadow: 0 0 5px var(--primary-color); }
    to { text-shadow: 0 0 15px var(--primary-color), 0 0 20px var(--accent-color); }
}
.subtitle { font-size: 1rem; margin-top: 5px; color: var(--accent-color); }
#museum {
    width: 100%; max-width: 800px; min-height: 400px;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    padding: 20px; background-color: rgba(17,17,17,0.8);
    border: 2px solid var(--primary-color); border-radius: 10px;
    box-shadow: 0 0 15px rgba(0,255,0,0.3); margin-bottom: 20px; position: relative; overflow: hidden;
}
#museum .year {
    position: absolute; top: 10px; right: 10px; background-color: var(--card-bg);
    padding: 5px 10px; border-radius: 15px; font-size: 0.8rem; border: 1px solid var(--primary-color);
}
.museum-item { width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 15px; }
.museum-item img { max-width: 100%; max-height: 300px; width: auto; height: auto; border: 2px solid var(--primary-color); border-radius: 8px; object-fit: contain; cursor: pointer; }
.museum-item blockquote { font-size: 1.5rem; font-style: italic; border-left: 3px solid var(--accent-color); padding-left: 15px; margin: 0; max-width: 90%; }
.museum-item pre { background-color: #111; border: 2px solid var(--primary-color); border-radius: 8px; padding: 10px; color: var(--accent-color); width: 90%; overflow-x: auto; text-align: left; position: relative; white-space: pre-wrap; }
.copy-btn { position: absolute; top: 5px; right: 10px; background: var(--primary-color); color: var(--bg-color); border: none; padding: 3px 8px; cursor: pointer; font-size: 0.8rem; border-radius: 4px; }
.caption { font-size: 1rem; color: var(--accent-color); margin-top: 10px; }
.controls { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; justify-content: center; }
button { background-color: var(--bg-color); color: var(--primary-color); border: 2px solid var(--primary-color); padding: 10px 20px; cursor: pointer; font-family: 'Courier New', monospace; font-weight: bold; transition: all 0.3s ease; border-radius: 5px; position: relative; overflow: hidden; }
button:hover { background-color: var(--primary-color); color: var(--bg-color); }
button.active { background-color: var(--primary-color); color: var(--bg-color); }
footer { margin-top: 40px; font-size: 0.8rem; color: var(--text-color); border-top: 1px solid var(--primary-color); padding-top: 15px; width: 100%; }
.footer-link { color: var(--accent-color); text-decoration: none; }
.footer-link:hover { color: var(--primary-color); text-decoration: underline; }
#visitorCount { margin-top: 10px; font-size: 1.2rem; color: var(--accent-color); }
/* Modals */
.modal, .info-modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); justify-content: center; align-items: center; }
.modal-content { max-width: 90%; max-height: 90%; border: 3px solid var(--primary-color); border-radius: 10px; box-shadow: 0 0 30px var(--primary-color); }
.close-modal { position: absolute; top: 20px; right: 35px; color: var(--primary-color); font-size: 40px; font-weight: bold; cursor: pointer; transition: color 0.3s; }
.close-modal:hover { color: var(--accent-color); }
.info-content { background-color: var(--card-bg); border: 2px solid var(--primary-color); border-radius: 10px; padding: 20px; max-width: 500px; width: 90%; box-shadow: 0 0 20px var(--primary-color); }
.info-content h2 { color: var(--primary-color); margin-top: 0; }
.info-content p { line-height: 1.5; }
.error-message { color: var(--secondary-color); font-size: 1.2rem; padding: 20px; }
.loading { color: var(--accent-color); font-size: 1.2rem; }
</style>
</head>
<body>

<header>
    <h1>Random Internet Museum</h1>
    <div class="subtitle">A nostalgic journey through digital history</div>
</header>

<div id="museum"><div class="loading">Loading museum artifacts...</div></div>

<div class="controls">
    <button id="prevBtn">Previous</button>
    <button id="nextBtn">Next</button>
    <button id="autoBtn">Auto Play</button>
    <button id="infoBtn">Info</button>
</div>

<div id="visitorCount">ðŸ‘¥ Live Visitors: Loading...</div>

<footer>
    Created by <a href="https://x.com/2mzya" class="footer-link" target="_blank">Mohamad Zahir</a>
</footer>

<!-- Image Zoom Modal -->
<div id="imageModal" class="modal">
    <span class="close-modal">&times;</span>
    <img class="modal-content" id="modalImage">
</div>

<!-- Info Modal -->
<div id="infoModal" class="info-modal"><div class="info-content"></div></div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

<script>
const museumDiv = document.getElementById('museum');
const nextBtn = document.getElementById('nextBtn');
const prevBtn = document.getElementById('prevBtn');
const autoBtn = document.getElementById('autoBtn');
const infoBtn = document.getElementById('infoBtn');
const imageModal = document.getElementById('imageModal');
const modalImage = document.getElementById('modalImage');
const closeModal = document.querySelector('.close-modal');
const infoModal = document.getElementById('infoModal');
const visitorCount = document.getElementById('visitorCount');

let data = [];
let currentIndex = 0;
let autoPlayInterval = null;
let autoPlaySpeed = 5000;
let isAutoPlaying = false;

// Load museum data from external JS file
async function loadMuseumData(){
    try{
        const response = await fetch('museum-data.js');
        if(!response.ok) throw new Error('Failed to load museum data');
        const scriptText = await response.text();
        const script = document.createElement('script');
        script.textContent = scriptText;
        document.head.appendChild(script);
        setTimeout(()=>{
            if(typeof museumData!=='undefined' && museumData.length>0){
                data = museumData;
                showItem(0);
            } else {
                showError('No museum data found.');
            }
        },100);
    }catch(e){
        console.error(e);
        showError('Failed to load museum data.');
    }
}

function showError(msg){
    museumDiv.innerHTML = `<div class="error-message">${msg}</div>`;
}

function showItem(i){
    if(!data.length) return;
    if(i<0) i=data.length-1;
    if(i>=data.length) i=0;
    currentIndex=i;
    const item=data[i];
    museumDiv.innerHTML='';
    const container=document.createElement('div');
    container.className='museum-item';
    const year=document.createElement('div');
    year.className='year';
    year.textContent=item.year;
    container.appendChild(year);

    if(item.type==='image'){
        const img=document.createElement('img');
        img.src=item.src;
        img.alt=item.caption||'Image';
        img.onload=()=>img.style.opacity='1';
        img.onerror=()=>{img.src='https://via.placeholder.com/600x300?text=Image+Not+Found'; img.alt='Image not available'; img.style.borderColor='var(--secondary-color)';};
        img.style.opacity='0'; img.style.transition='opacity 0.5s ease';
        img.addEventListener('click',()=>openImageModal(item.src));
        container.appendChild(img);
        if(item.caption){
            const cap=document.createElement('div');
            cap.className='caption';
            cap.textContent=item.caption;
            container.appendChild(cap);
        }
    } else if(item.type==='quote'){
        const quote=document.createElement('blockquote');
        quote.textContent=`"${item.text}"`;
        container.appendChild(quote);
        if(item.author){
            const author=document.createElement('p');
            author.textContent=`- ${item.author}`;
            author.style.textAlign='right'; author.style.marginTop='10px';
            container.appendChild(author);
        }
    } else if(item.type==='code'){
        const pre=document.createElement('pre');
        pre.innerHTML=`<code>${item.code}</code>`;
        const copyBtn=document.createElement('button');
        copyBtn.textContent='Copy';
        copyBtn.className='copy-btn';
        copyBtn.onclick=()=>{navigator.clipboard.writeText(item.code); alert('Copied!');};
        pre.appendChild(copyBtn);
        container.appendChild(pre);
    } else if(item.type==='ascii'){
        const pre=document.createElement('pre');
        pre.textContent=item.ascii;
        pre.style.color='var(--accent-color)';
        pre.style.border='2px solid var(--primary-color)';
        pre.style.borderRadius='8px';
        pre.style.padding='10px';
        pre.style.backgroundColor='#111';
        pre.style.width='90%';
        pre.style.overflowX='auto';
        pre.style.whiteSpace='pre';
        container.appendChild(pre);
        if(item.caption){
            const cap=document.createElement('div');
            cap.className='caption';
            cap.textContent=item.caption;
            container.appendChild(cap);
        }
    }
    museumDiv.appendChild(container);
}

function nextItem(){showItem(currentIndex+1);}
function prevItem(){showItem(currentIndex-1);}
function toggleAutoPlay(){
    if(isAutoPlaying){ clearInterval(autoPlayInterval); autoPlayInterval=null; autoBtn.textContent='Auto Play'; autoBtn.classList.remove('active'); isAutoPlaying=false;}
    else{ autoPlayInterval=setInterval(nextItem,autoPlaySpeed); autoBtn.textContent='Stop Auto'; autoBtn.classList.add('active'); isAutoPlaying=true;}
}

function openImageModal(src){ modalImage.src=src; imageModal.style.display='flex'; }

function toggleInfo(){
    const item=data[currentIndex];
    if(!item||!item.info) return;
    const infoContent=infoModal.querySelector('.info-content');
    infoContent.innerHTML=`<h2>Info</h2><p>${item.info}</p><button id="closeInfo">Close</button>`;
    infoModal.style.display='flex';
    document.getElementById('closeInfo').addEventListener('click',()=>{infoModal.style.display='none';});
}

function setupEventListeners(){
    nextBtn.addEventListener('click',nextItem);
    prevBtn.addEventListener('click',prevItem);
    autoBtn.addEventListener('click',toggleAutoPlay);
    infoBtn.addEventListener('click',toggleInfo);
    closeModal.addEventListener('click',()=>{imageModal.style.display='none';});
    window.addEventListener('click',(e)=>{if(e.target===imageModal) imageModal.style.display='none'; if(e.target===infoModal) infoModal.style.display='none';});
    document.addEventListener('keydown',(e)=>{
        if(e.key==='ArrowRight') nextItem();
        if(e.key==='ArrowLeft') prevItem();
        if(e.key==='Escape'){imageModal.style.display='none'; infoModal.style.display='none';}
        if(e.key===' '||e.key==='Spacebar'){e.preventDefault(); toggleAutoPlay();}
    });
}

// Firebase Live Visitor Counter
function setupFirebase(){
    const firebaseConfig = {
        apiKey: "AIzaSyBstw5bNuq7u6ahJzN94fsRxcLIGNVGk0U",
        authDomain: "livevisitors2025.firebaseapp.com",
        databaseURL: "https://livevisitors2025-default-rtdb.firebaseio.com",
        projectId: "livevisitors2025",
        storageBucket: "livevisitors2025.appspot.com",
        messagingSenderId: "550260737631",
        appId: "1:550260737631:web:d2cc207825df792c057dea",
        measurementId: "G-K027GT40V1"
    };
    if(!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db=firebase.database();
    const visitorsRef=db.ref('visitors/count');
    visitorsRef.on('value',(snapshot)=>{visitorCount.textContent=`ðŸ‘¥ Live Visitors: ${snapshot.val()||0}`;});
    visitorsRef.transaction(c=> (c||0)+1);
    const connRef=db.ref('.info/connected');
    connRef.on('value',(snap)=>{if(snap.val()===true) visitorsRef.onDisconnect().transaction(c=>Math.max(0,(c||0)-1));});
}

document.addEventListener('DOMContentLoaded',()=>{
    setupEventListeners();
    loadMuseumData();
    try{ setupFirebase(); } catch(e){ console.error("Firebase failed:",e); visitorCount.textContent="ðŸ‘¥ Live Visitors: Unknown"; }
});
</script>
</body>
</html>
